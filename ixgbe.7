.\" Man page generated from reStructuredText.
.
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.TH "IXGBE" "7" "July 24, 2025" "" "Linux ixgbe README"
.SH NAME
ixgbe \- ixgbe Linux* Base Driver for Intel(R) Ethernet Network Connections
.SS Contents
.INDENT 0.0
.IP \(bu 2
\fI\%ixgbe Linux* Base Driver for Intel(R) Ethernet Network Connections\fP
.INDENT 2.0
.IP \(bu 2
\fI\%Overview\fP
.IP \(bu 2
\fI\%Related Documentation\fP
.IP \(bu 2
\fI\%Identifying Your Adapter\fP
.IP \(bu 2
\fI\%Important Notes\fP
.IP \(bu 2
\fI\%Building and Installation\fP
.IP \(bu 2
\fI\%Command Line Parameters\fP
.IP \(bu 2
\fI\%Additional Features and Configurations\fP
.IP \(bu 2
\fI\%Known Issues/Troubleshooting\fP
.IP \(bu 2
\fI\%Support\fP
.IP \(bu 2
\fI\%License\fP
.IP \(bu 2
\fI\%Trademarks\fP
.UNINDENT
.UNINDENT
.SH OVERVIEW
.sp
This driver supports Linux* kernel versions 2.6.x and newer. However, some
features may require a newer kernel version. The associated Virtual Function
(VF) driver for this driver is ixgbevf.
.sp
Driver information can be obtained using ethtool, lspci, and ip. Instructions
on updating ethtool can be found in the section Additional Configurations later
in this document.
.sp
This driver is only supported as a loadable module at this time. Intel is not
supplying patches against the kernel source to allow for static linking of the
drivers.
.sp
For questions related to hardware requirements, refer to the documentation
supplied with your Intel adapter. All hardware requirements listed apply to use
with Linux.
.sp
This driver supports XDP (Express Data Path) on kernel 4.14 and later and
AF_XDP zero\-copy on kernel 4.18 and later. Note that XDP is blocked for frame
sizes larger than 3KB.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
Devices based on the Intel(R) Ethernet Connection X552 and Intel(R)
Ethernet Connection X553 do not support the following features:
.INDENT 0.0
.IP \(bu 2
Energy Efficient Ethernet (EEE)
.IP \(bu 2
Intel PROSet for Windows Device Manager
.IP \(bu 2
Intel ANS teams or VLANs (LBFO is supported)
.IP \(bu 2
Fibre Channel over Ethernet (FCoE)
.IP \(bu 2
Data Center Bridging (DCB)
.IP \(bu 2
IPSec Offloading
.IP \(bu 2
MACSec Offloading
.UNINDENT
.sp
In addition, SFP+ devices based on the Intel(R) Ethernet Connection X552 and
Intel(R) Ethernet Connection X553 do not support the following features:
.INDENT 0.0
.IP \(bu 2
Speed and duplex auto\-negotiation
.IP \(bu 2
Wake on LAN
.IP \(bu 2
1000BASE\-T SFP Modules
.UNINDENT
.UNINDENT
.UNINDENT
.SH RELATED DOCUMENTATION
.sp
See the \(dqIntel(R) Ethernet Adapters and Devices User Guide\(dq for additional
information on features. It is available on the Intel website at
\fI\%https://cdrdv2.intel.com/v1/dl/getContent/705831\fP\&.
.SH IDENTIFYING YOUR ADAPTER
.sp
The driver is compatible with devices based on the following:
.INDENT 0.0
.IP \(bu 2
Intel(R) Ethernet Controller 82598
.IP \(bu 2
Intel(R) Ethernet Controller 82599
.IP \(bu 2
Intel(R) Ethernet Controller X520
.IP \(bu 2
Intel(R) Ethernet Controller X540
.IP \(bu 2
Intel(R) Ethernet Controller x550
.IP \(bu 2
Intel(R) Ethernet Controller X552
.IP \(bu 2
Intel(R) Ethernet Controller X553
.IP \(bu 2
Intel(R) Ethernet Controller E610
.UNINDENT
.sp
For information on how to identify your adapter, and for the latest Intel
network drivers, refer to the Intel Support website at
\fI\%https://www.intel.com/support\fP\&.
.SS SFP+ Devices with Pluggable Optics
.SS 82599\-Based Adapters
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
If your 82599\-based Intel(R) Network Adapter came with Intel optics or is
an Intel(R) Ethernet Server Adapter X520\-2, then it only supports Intel
optics and/or the direct attach cables listed below.
.IP \(bu 2
When 82599\-based SFP+ devices are connected back to back, they should be
set to the same Speed setting via ethtool. Results may vary if you mix
speed settings.
.UNINDENT
.UNINDENT
.UNINDENT
.TS
center;
|l|l|l|.
_
T{
Supplier
T}	T{
Type
T}	T{
Part Numbers
T}
_
T{
\fBSR Modules:\fP
T}	T{
T}	T{
T}
_
T{
Intel
T}	T{
DUAL RATE 1G/10G SFP+ SR (bailed)
T}	T{
FTLX8571D3BCV\-IT
T}
_
T{
Intel
T}	T{
DUAL RATE 1G/10G SFP+ SR (bailed)
T}	T{
AFBR\-703SDZ\-IN2
T}
_
T{
Intel
T}	T{
DUAL RATE 1G/10G SFP+ SR (bailed)
T}	T{
AFBR\-703SDDZ\-IN1
T}
_
T{
\fBLR Modules:\fP
T}	T{
T}	T{
T}
_
T{
Intel
T}	T{
DUAL RATE 1G/10G SFP+ LR (bailed)
T}	T{
FTLX1471D3BCV\-IT
T}
_
T{
Intel
T}	T{
DUAL RATE 1G/10G SFP+ LR (bailed)
T}	T{
AFCT\-701SDZ\-IN2
T}
_
T{
Intel
T}	T{
DUAL RATE 1G/10G SFP+ LR (bailed)
T}	T{
AFCT\-701SDDZ\-IN1
T}
_
.TE
.sp
The following is a list of third\-party SFP+ modules that have received some
testing. Not all modules are applicable to all devices.
.TS
center;
|l|l|l|.
_
T{
Supplier
T}	T{
Type
T}	T{
Part Numbers
T}
_
T{
Finisar
T}	T{
SFP+ SR bailed, 10g single rate
T}	T{
FTLX8571D3BCL
T}
_
T{
Avago
T}	T{
SFP+ SR bailed, 10g single rate
T}	T{
AFBR\-700SDZ
T}
_
T{
Finisar
T}	T{
SFP+ LR bailed, 10g single rate
T}	T{
FTLX1471D3BCL
T}
_
T{
Finisar
T}	T{
DUAL RATE 1G/10G SFP+ SR (No Bail)
T}	T{
FTLX8571D3QCV\-IT
T}
_
T{
Avago
T}	T{
DUAL RATE 1G/10G SFP+ SR (No Bail)
T}	T{
AFBR\-703SDZ\-IN1
T}
_
T{
Finisar
T}	T{
DUAL RATE 1G/10G SFP+ LR (No Bail)
T}	T{
FTLX1471D3QCV\-IT
T}
_
T{
Avago
T}	T{
DUAL RATE 1G/10G SFP+ LR (No Bail)
T}	T{
AFCT\-701SDZ\-IN1
T}
_
T{
Finisar
T}	T{
1000BASE\-T SFP
T}	T{
FCLF8522P2BTL
T}
_
T{
Avago
T}	T{
1000BASE\-T
T}	T{
ABCU\-5710RZ
T}
_
T{
HP
T}	T{
1000BASE\-SX SFP
T}	T{
453153\-001
T}
_
.TE
.sp
82599\-based adapters support all passive and active limiting direct attach
cables that comply with SFF\-8431 v4.1 and SFF\-8472 v10.4 specifications.
.SS Turning the laser off or on for SFP+
.sp
Use the following to turn the laser off and on:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ip link set [down|up] dev <ethX>
.ft P
.fi
.UNINDENT
.UNINDENT
.SS 82599\-Based QSFP+ Adapters
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
If your 82599\-based Intel(R) Network Adapter came with Intel optics, it
only supports Intel optics.
.IP \(bu 2
82599\-based QSFP+ adapters only support 4x10 Gbps connections.
1x40 Gbps connections are not supported. QSFP+ link partners must be
configured for 4x10 Gbps.
.IP \(bu 2
82599\-based QSFP+ adapters do not support automatic link speed detection.
The link speed must be configured to either 10 Gbps or 1 Gbps to match the
link partners speed capabilities. Incorrect speed configurations will
result in failure to link.
.IP \(bu 2
Intel(R) Ethernet Converged Network Adapter X520\-Q1 only supports the
optics and direct attach cables listed below.
.UNINDENT
.UNINDENT
.UNINDENT
.TS
center;
|l|l|l|.
_
T{
Supplier
T}	T{
Type
T}	T{
Part Numbers
T}
_
T{
Intel
T}	T{
DUAL RATE 1G/10G QSFP+ SRL (bailed)
T}	T{
E10GQSFPSR
T}
_
.TE
.sp
82599\-based QSFP+ adapters support all passive and active limiting QSFP+
direct attach cables that comply with SFF\-8436 v4.1 specifications.
.SS 82598\-Based Adapters
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
Intel(R) Ethernet Network Adapters that support removable optical modules
only support their original module type (for example, the Intel(R) 10
Gigabit SR Dual Port Express Module only supports SR optical modules).
If you plug in a different type of module, the driver will not load.
.IP \(bu 2
Hot Swapping/hot plugging optical modules is not supported.
.IP \(bu 2
Only single speed, 10 gigabit modules are supported.
.IP \(bu 2
LAN on Motherboard (LOMs) may support DA, SR, or LR modules. Other module
types are not supported. Please see your system documentation for details.
.UNINDENT
.UNINDENT
.UNINDENT
.sp
The following is a list of SFP+ modules and direct attach cables that have
received some testing. Not all modules are applicable to all devices.
.TS
center;
|l|l|l|.
_
T{
Supplier
T}	T{
Type
T}	T{
Part Numbers
T}
_
T{
Finisar
T}	T{
SFP+ SR bailed, 10g single rate
T}	T{
FTLX8571D3BCL
T}
_
T{
Avago
T}	T{
SFP+ SR bailed, 10g single rate
T}	T{
AFBR\-700SDZ
T}
_
T{
Finisar
T}	T{
SFP+ LR bailed, 10g single rate
T}	T{
FTLX1471D3BCL
T}
_
.TE
.sp
82598\-based adapters support all passive direct attach cables that comply with
SFF\-8431 v4.1 and SFF\-8472 v10.4 specifications. Active direct attach cables
are not supported.
.sp
Third\-party optic modules and cables referred to above are listed only for the
purpose of highlighting third party specifications and potential
compatibility, and are not recommendations or endorsements or sponsorship of
any third party\(aqs product by Intel. Intel is not endorsing or promoting
products made by any third party and the third party reference is provided
only to share information regarding certain optic modules and cables with the
above specifications. There may be other manufacturers or suppliers, producing
or supplying optic modules and cables with similar or matching descriptions.
Customers must use their own discretion and diligence to purchase optic
modules and cables from any third party of their choice. Customers are solely
responsible for assessing the suitability of the product and/or devices and
for the selection of the vendor for purchasing any product. THE OPTIC MODULES
AND CABLES REFERRED TO ABOVE ARE NOT WARRANTED OR SUPPORTED BY INTEL. INTEL
ASSUMES NO LIABILITY WHATSOEVER, AND INTEL DISCLAIMS ANY EXPRESS OR IMPLIED
WARRANTY, RELATING TO SALE AND/OR USE OF SUCH THIRD PARTY PRODUCTS OR
SELECTION OF VENDOR BY CUSTOMERS.
.SH IMPORTANT NOTES
.SS Do not unload port driver if VF with active VM is bound to it
.sp
Do not unload a port\(aqs driver if a Virtual Function (VF) with an active Virtual
Machine (VM) is bound to it. Doing so will cause the port to appear to hang.
Once the VM shuts down, or otherwise releases the VF, the command will complete.
.SS Configuring SR\-IOV for improved network security
.sp
In a virtualized environment, on Intel(R) Ethernet Network Adapters that
support SR\-IOV, the virtual function (VF) may be subject to malicious behavior.
Software\-generated layer two frames, like IEEE 802.3x (link flow control), IEEE
802.1Qbb (priority based flow\-control), and others of this type, are not
expected and can throttle traffic between the host and the virtual switch,
reducing performance. To resolve this issue, and to ensure isolation from
unintended traffic streams, configure all SR\-IOV enabled ports for VLAN tagging
from the administrative interface on the PF. This configuration allows
unexpected, and potentially malicious, frames to be dropped.
.SH BUILDING AND INSTALLATION
.SS To manually build the driver
.INDENT 0.0
.IP 1. 3
Move the base driver tar file to the directory of your choice.
For example, use \fB/home/username/ixgbe\fP or \fB/usr/local/src/ixgbe\fP\&.
.IP 2. 3
Untar/unzip the archive, where \fB<x.x.x>\fP is the version number for the
driver tar file:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
tar zxf ixgbe\-<x.x.x>.tar.gz
.ft P
.fi
.UNINDENT
.UNINDENT
.IP 3. 3
Change to the driver src directory, where \fB<x.x.x>\fP is the version number
for the driver tar:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
cd ixgbe\-<x.x.x>/src/
.ft P
.fi
.UNINDENT
.UNINDENT
.IP 4. 3
Compile the driver module:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
make install
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
The binary will be installed as:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
/lib/modules/<KERNEL VER>/updates/drivers/net/ethernet/intel/ixgbe/ixgbe.ko
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
The install location listed above is the default location. This may differ
for various Linux distributions.
.IP 5. 3
Load the module using the modprobe command.
.sp
To check the version of the driver and then load it:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
modinfo ixgbe
modprobe ixgbe [parameter=port1_value,port2_value]
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Alternately, make sure that any older ixgbe drivers are removed from the
kernel before loading the new module:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
rmmod ixgbe; modprobe ixgbe
.ft P
.fi
.UNINDENT
.UNINDENT
.IP 6. 3
Assign an IP address to the interface by entering the following,
where \fB<ethX>\fP is the interface name that was shown in dmesg after
modprobe:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
ip address add <IP_address>/<netmask bits> dev <ethX>
.ft P
.fi
.UNINDENT
.UNINDENT
.IP 7. 3
Verify that the interface works. Enter the following, where \fBIP_address\fP
is the IP address for another machine on the same subnet as the interface
that is being tested:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
ping <IP_address>
.ft P
.fi
.UNINDENT
.UNINDENT
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
For certain distributions like (but not limited to) Red Hat Enterprise
Linux 7 and Ubuntu, once the driver is installed, you may need to update the
initrd/initramfs file to prevent the OS loading old versions of the ixgbe
driver.
.sp
For Red Hat distributions:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
dracut \-\-force
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
For Ubuntu:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
update\-initramfs \-u
.ft P
.fi
.UNINDENT
.UNINDENT
.UNINDENT
.UNINDENT
.SS To build a binary RPM package of this driver
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
RPM functionality has only been tested in Red Hat distributions.
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 1. 3
Run the following command, where \fB<x.x.x>\fP is the version number for the
driver tar file:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
rpmbuild \-tb ixgbe\-<x.x.x>.tar.gz
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 3.0
.INDENT 3.5
For the build to work properly, the currently running kernel MUST
match the version and configuration of the installed kernel sources. If
you have just recompiled the kernel, reboot the system before building.
.UNINDENT
.UNINDENT
.IP 2. 3
After building the RPM, the last few lines of the tool output contain the
location of the RPM file that was built. Install the RPM with one of the
following commands, where \fB<RPM>\fP is the location of the RPM file:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
rpm \-Uvh <RPM>
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
or:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
dnf/yum localinstall <RPM>
.ft P
.fi
.UNINDENT
.UNINDENT
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
To compile the driver on some kernel/arch combinations, you may need to
install a package with the development version of libelf (e.g. libelf\-dev,
libelf\-devel, elfutils\-libelf\-devel).
.IP \(bu 2
When compiling an out\-of\-tree driver, details will vary by distribution.
However, you will usually need a kernel\-devel RPM or some RPM that provides
the kernel headers at a minimum. The RPM kernel\-devel will usually fill in
the link at \fB/lib/modules/\(aquname \-r\(aq/build\fP\&.
.UNINDENT
.UNINDENT
.UNINDENT
.SS To build ixgbe driver with DCA
.sp
If your kernel supports Direct Cache Access (DCA), the driver will build by
default with DCA enabled.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
DCA is not supported on X550\-based and E610\-based adapters.
.UNINDENT
.UNINDENT
.SH COMMAND LINE PARAMETERS
.sp
If the driver is built as a module, enter optional parameters on the command
line with the following syntax:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
modprobe ixgbe [<option>=<VAL1>,<VAL2>,...]
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
There needs to be a \fB<VAL#>\fP for each network port in the system supported by
this driver. The values will be applied to each instance, in function order.
For example:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
modprobe ixgbe InterruptThrottleRate=16000,16000
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
In this case, there are two network ports supported by ixgbe in the system.
.INDENT 0.0
.IP \(bu 2
The default value for each parameter is generally the recommended setting,
unless otherwise noted.
.UNINDENT
.SS RSS
.sp
Valid Range: 0\-16
.INDENT 0.0
.IP \(bu 2
0 = Assign up to the lesser value of the number of CPUs or the number of queues
.IP \(bu 2
X = Assign X queues, where X is less than or equal to the maximum number of
queues (16 queues).
.UNINDENT
.sp
RSS also affects the number of transmit queues allocated on 2.6.23 and
newer kernels with \fBCONFIG_NETDEVICES_MULTIQUEUE\fP set in the kernel \fB\&.config\fP
file. \fBCONFIG_NETDEVICES_MULTIQUEUE\fP only exists from 2.6.23 to 2.6.26. Other
options enable multiqueue in 2.6.27 and newer kernels.
.SS Multiqueue
.sp
Valid Range: 0, 1
.INDENT 0.0
.IP \(bu 2
0 = Disables Multiple Queue support
.IP \(bu 2
1 = Enabled Multiple Queue support (a prerequisite for RSS)
.UNINDENT
.SS Direct Cache Access (DCA)
.sp
Valid Range: 0, 1
.INDENT 0.0
.IP \(bu 2
0 = Disables DCA support in the driver
.IP \(bu 2
1 = Enables DCA support in the driver
.UNINDENT
.sp
If the driver is enabled for DCA, this parameter allows load\-time control of
the feature.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
DCA is not supported on X550\-based and E610\-based adapters.
.UNINDENT
.UNINDENT
.SS IntMode
.sp
Valid Range: 0\-2
.INDENT 0.0
.IP \(bu 2
0 = Legacy Int
.IP \(bu 2
1 = MSI
.IP \(bu 2
2 = MSI\-X
.UNINDENT
.sp
IntMode controls the allowed load time control over the type of interrupt
registered for by the driver. MSI\-X is required for multiple queue
support, and some kernels and combinations of kernel \fB\&.config\fP options
will force a lower level of interrupt support.
\fBcat /proc/interrupts\fP will show different values for each type of interrupt.
.SS InterruptThrottleRate
.sp
Valid Range:
.INDENT 0.0
.IP \(bu 2
0=off
.IP \(bu 2
1=dynamic
.IP \(bu 2
\fB<min_ITR>\-<max_ITR>\fP
.UNINDENT
.sp
Interrupt Throttle Rate controls the number of interrupts each interrupt
vector can generate per second. Increasing ITR lowers latency at the cost of
increased CPU utilization, though it may help throughput in some circumstances.
.INDENT 0.0
.IP \(bu 2
0 = Setting \fBInterruptThrottleRate\fP to 0 turns off any interrupt moderation
and may improve small packet latency. However, this is generally not
suitable for bulk throughput traffic due to the increased CPU utilization
of the higher interrupt rate.
.sp
\fBNOTE:\fP
.INDENT 2.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
On 82599, and X540, X550\-based and E610\-based adapters, disabling
\fBInterruptThrottleRate\fP will also result in the driver disabling
HW RSC.
.IP \(bu 2
On 82598\-based adapters, disabling \fBInterruptThrottleRate\fP will also
result in disabling LRO (Large Receive Offloads).
.UNINDENT
.UNINDENT
.UNINDENT
.IP \(bu 2
1 = Setting \fBInterruptThrottleRate\fP to Dynamic mode attempts to moderate
interrupts per vector while maintaining very low latency. This can
sometimes cause extra CPU utilization. If planning on deploying ixgbe
in a latency sensitive environment, this parameter should be considered.
.IP \(bu 2
\fB<min_ITR>\-<max_ITR>\fP = 956\-488281
.sp
Setting \fBInterruptThrottleRate\fP to a value greater or equal to \fB<min_ITR>\fP
will program the adapter to send at most that many interrupts per second,
even if more packets have come in. This reduces interrupt load on the system
and can lower CPU utilization under heavy load, but will increase latency as
packets are not processed as quickly.
.UNINDENT
.SS LLI (Low Latency Interrupts)
.sp
Low Latency Interrupts (LLI) allow for immediate generation of an interrupt
upon processing receive packets that match certain criteria as set by the
parameters described below. LLI parameters are not enabled when Legacy
interrupts are used. You must be using MSI or MSI\-X (see
\fBcat /proc/interrupts\fP) to successfully use LLI.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
LLI is not supported on X550\-based and E610\-based adapters.
.UNINDENT
.UNINDENT
.SS LLIPort
.sp
Valid Range: 0\-65535
.sp
LLI is configured with the \fBLLIPort\fP command line parameter, which specifies
which TCP port should generate Low Latency Interrupts.
.sp
For example, using \fBLLIPort=80\fP would cause the board to generate an immediate
interrupt upon receipt of any packet sent to TCP port 80 on the local machine.
.sp
\fBWARNING:\fP
.INDENT 0.0
.INDENT 3.5
Enabling LLI can result in an excessive number of interrupts/second
that may cause problems with the system and in some cases may cause a kernel
panic.
.UNINDENT
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
LLI is not supported on X550\-based and E610\-based adapters.
.UNINDENT
.UNINDENT
.SS LLIPush
.sp
Valid Range: 0\-1
.sp
\fBLLIPush\fP can be set to be enabled or disabled (default). It is most effective
in an environment with many small transactions.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
Enabling LLIPush may allow a denial of service attack.
.IP \(bu 2
LLI is not supported on X550\-based and E610\-based adapters.
.UNINDENT
.UNINDENT
.UNINDENT
.SS LLISize
.sp
Valid Range: 0\-1500
.sp
\fBLLISize\fP causes an immediate interrupt if the board receives a packet smaller
than the specified size.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
LLI is not supported on X550\-based and E610\-based adapters.
.UNINDENT
.UNINDENT
.SS LLIEType
.sp
Valid Range: 0\-0x8FFF
.sp
This parameter specifies the Low Latency Interrupt (LLI) Ethernet protocol type.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
LLI is not supported on X550\-based and E610\-based adapters.
.UNINDENT
.UNINDENT
.SS LLIVLANP
.sp
Valid Range: 0\-7
.sp
This parameter specifies the LLI on VLAN priority threshold.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
LLI is not supported on X550\-based and E610\-based adapters.
.UNINDENT
.UNINDENT
.SS FdirPballoc
.sp
Valid Range: 1\-3
.sp
Specifies the Intel(R) Ethernet Flow Director allocated packet buffer size.
.INDENT 0.0
.IP \(bu 2
1 = 64k
.IP \(bu 2
2 = 128k
.IP \(bu 2
3 = 256k
.UNINDENT
.SS AtrSampleRate
.sp
Valid Range: 0\-255
.sp
This parameter is used with the Intel Ethernet Flow Director and is the
software ATR transmit packet sample rate. For example, when \fBAtrSampleRate\fP
is set to 20, every 20th packet looks to see if the packet will create a new
flow. A value of 0 indicates that ATR should be disabled and no samples will
be taken.
.SS max_vfs
.sp
Valid Range:  1\-63
.sp
This parameter adds support for SR\-IOV. It causes the driver to spawn up to
\fBmax_vfs\fP worth of virtual functions.
.sp
If the value is greater than 0 it will also force the \fBVMDq\fP parameter to be
1 or more.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
This parameter is only used on kernel 3.7.x and below. On kernel
3.8.x and above, use sysfs to enable VFs. Use sysfs for Red Hat distributions.
.UNINDENT
.UNINDENT
.sp
For example, you can create 4 VFs as follows:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
echo 4 > /sys/class/net/<ethX>/device/sriov_numvfs
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
To disable VFs, write 0 to the same file:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
echo 0 > /sys/class/net/<ethX>/device/sriov_numvfs
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
The parameters for the driver are referenced by position. Thus, if you have a
dual port adapter, or more than one adapter in your system, and want N virtual
functions per port, you must specify a number for each port with each parameter
separated by a comma. For example, the following will spawn 4 VFs on the first
port:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
modprobe ixgbe max_vfs=4
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
The following will spawn 2 VFs on the first port and 4 VFs on the second port:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
modprobe ixgbe max_vfs=2,4
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
Use caution when loading the driver with these parameters. Depending
on your system configuration, number of slots, etc., it is impossible
to predict in all cases where the positions would be on the command line.
.IP \(bu 2
Neither the device nor the driver control how VFs are mapped into config
space. Bus layout will vary by operating system. On operating systems that
support it, you can check sysfs to find the mapping.
.IP \(bu 2
When either SR\-IOV mode or VMDq mode is enabled, hardware VLAN filtering
and VLAN tag stripping/insertion will remain enabled. Please remove the old
VLAN filter before the new VLAN filter is added. For example:
.INDENT 2.0
.INDENT 3.5
.sp
.nf
.ft C
ip link set eth0 vf 0 vlan 100    // set vlan 100 for VF 0
ip link set eth0 vf 0 vlan 0      // Delete vlan 100
ip link set eth0 vf 0 vlan 200    // set a new vlan 200 for VF 0
.ft P
.fi
.UNINDENT
.UNINDENT
.UNINDENT
.UNINDENT
.UNINDENT
.sp
With kernel 3.6, the driver supports the simultaneous usage of \fBmax_vfs\fP and
DCB features, subject to the constraints described below. Prior to kernel 3.6,
the driver did not support the simultaneous operation of \fBmax_vfs\fP greater
than 0 and the DCB features (multiple traffic classes utilizing Priority Flow
Control and Extended Transmission Selection).
.sp
When DCB is enabled, network traffic is transmitted and received through
multiple traffic classes (packet buffers in the NIC). The traffic is associated
with a specific class based on priority, which has a value of 0 through 7 used
in the VLAN tag. When SR\-IOV is not enabled, each traffic class is associated
with a set of receive/transmit descriptor queue pairs. The number of queue
pairs for a given traffic class depends on the hardware configuration. When
SR\-IOV is enabled, the descriptor queue pairs are grouped into pools. The
Physical Function (PF) and each Virtual Function (VF) is allocated a pool of
receive/transmit descriptor queue pairs. When multiple traffic classes are
configured (for example, DCB is enabled), each pool contains a queue pair from
each traffic class. When a single traffic class is configured in the hardware,
the pools contain multiple queue pairs from the single traffic class.
.sp
The number of VFs that can be allocated depends on the number of traffic
classes that can be enabled. The configurable number of traffic classes for
each enabled VF is as follows:
.INDENT 0.0
.IP \(bu 2
0 \- 15 VFs = Up to 8 traffic classes, depending on device support
.IP \(bu 2
16 \- 31 VFs = Up to 4 traffic classes
.IP \(bu 2
32 \- 63 VFs = 1 traffic class
.UNINDENT
.sp
When VFs are configured, the PF is allocated one pool as well. The PF supports
the DCB features with the constraint that each traffic class will only use a
single queue pair. When zero VFs are configured, the PF can support multiple
queue pairs per traffic class.
.SS LRO
.sp
Valid Range: 0 (off), 1 (on)
.sp
Large Receive Offload (LRO) is a technique for increasing inbound throughput
of high\-bandwidth network connections by reducing CPU overhead. It works by
aggregating multiple incoming packets from a single stream into a larger
buffer before they are passed higher up the networking stack, thus reducing
the number of packets that have to be processed. LRO combines multiple
Ethernet frames into a single receive in the stack, thereby potentially
decreasing CPU utilization for receives.
.sp
This technique is also referred to as Hardware Receive Side Coalescing
(HW RSC). 82599, X540, X550\-based and E610\-based adapters support HW RSC. The
LRO parameter controls HW RSC enablement.
.sp
You can verify that the driver is using LRO by looking at these counters in
ethtool:
.INDENT 0.0
.TP
.B hw_rsc_aggregated
Counts total packets that were combined
.TP
.B hw_rsc_flushed
Counts the number of packets flushed out of LRO
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
IPv6 and UDP are not supported by LRO.
.UNINDENT
.UNINDENT
.SS EEE (Energy Efficient Ethernet)
.sp
Valid Range: 0\-1
.INDENT 0.0
.IP \(bu 2
0 = Disables EEE
.IP \(bu 2
1 = Enables EEE
.UNINDENT
.sp
A link between two EEE\-compliant devices will result in periodic bursts of data
followed by periods where the link is in an idle state. This Low Power Idle (LPI)
state is supported at 1Gbps and 10Gbps link speeds.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
EEE support requires auto\-negotiation.
.IP \(bu 2
Both link partners must support EEE.
.IP \(bu 2
EEE is not supported on all Intel(R) Ethernet Network devices or at all
link speeds.
.UNINDENT
.UNINDENT
.UNINDENT
.sp
Example:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-\-show\-eee <ethX>
ethtool \-\-set\-eee <ethX> [eee on|off]
.ft P
.fi
.UNINDENT
.UNINDENT
.SS DMAC
.sp
Valid Range: 0, 41\-10000
.sp
This parameter enables or disables DMA Coalescing (DMAC) feature. Values are in
microseconds and set the internal DMA Coalescing internal timer.
.sp
DMAC is available on Intel(R) X550 (and later) and E610\-based based adapters.
.sp
DMA (Direct Memory Access) allows the network device to move packet data
directly to the system\(aqs memory, reducing CPU utilization. However, the
frequency and random intervals at which packets arrive do not allow the system
to enter a lower power state. DMA Coalescing allows the adapter to collect
packets before it initiates a DMA event. This may increase network latency but
also increases the chances that the system will enter a lower power state.
Turning on DMA Coalescing may save energy with kernel 2.6.32 and newer. DMA
Coalescing must be enabled across all active ports in order to save platform
power.
.sp
InterruptThrottleRate (ITR) should be set to dynamic. When \fBITR=0\fP, DMA
Coalescing is automatically disabled.
.SS MDD (Malicious Driver Detection)
.sp
Valid Range: 0\-1
.INDENT 0.0
.IP \(bu 2
0 = Disabled
.IP \(bu 2
1 = Enabled
.UNINDENT
.sp
This parameter is only relevant for devices operating in SR\-IOV mode.
When this parameter is set, the driver detects malicious VF driver and
disables its Tx/Rx queues until a VF driver reset occurs.
.SH ADDITIONAL FEATURES AND CONFIGURATIONS
.SS ethtool
.sp
The driver utilizes the ethtool interface for driver configuration and
diagnostics, as well as displaying statistical information. The latest ethtool
version is required for this functionality. Download it at
\fI\%https://kernel.org/pub/software/network/ethtool/\fP\&.
.SS Configuring the Driver on Different Distributions
.sp
Configuring a network driver to load properly when the system is started is
distribution dependent. Typically, the configuration process involves adding an
alias line to \fB/etc/modules.conf\fP or \fB/etc/modprobe.conf\fP as well as editing
other system startup scripts and/or configuration files. Many popular Linux
distributions ship with tools to make these changes for you. To learn the
proper way to configure a network device for your system, refer to your
distribution documentation. If during this process you are asked for the driver
or module name, the name for the Base Driver is ixgbe.
.sp
For example, if you install the ixgbe driver for two adapters (eth0 and eth1)
and want to set the interrupt mode to MSI\-X and MSI, respectively, add the
following to \fBmodules.conf\fP or \fB/etc/modprobe.conf\fP:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
alias eth0 ixgbe
alias eth1 ixgbe
options ixgbe IntMode=2,1
.ft P
.fi
.UNINDENT
.UNINDENT
.SS Viewing Link Messages
.sp
Link messages will not be displayed to the console if the distribution is
restricting system messages. In order to see network driver link messages on
your console, set dmesg to eight by entering the following:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
dmesg \-n 8
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
This setting is not saved across reboots.
.UNINDENT
.UNINDENT
.SS Jumbo Frames
.sp
Jumbo Frames support is enabled by changing the Maximum Transmission Unit (MTU)
to a value larger than the default value of 1500.
.sp
Use the ip command to increase the MTU size. For example, enter the following
where \fB<ethX>\fP is the interface number:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ip link set mtu 9000 dev <ethX>
ip link set up dev <ethX>
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
This setting is not saved across reboots.
.sp
Add \fBMTU=9000\fP to the following file to make the setting change permanent:
.INDENT 0.0
.IP \(bu 2
For RHEL: \fB/etc/sysconfig/network\-scripts/ifcfg\-<ethX>\fP
.IP \(bu 2
For SLES: \fB/etc/sysconfig/network/<config_file>\fP
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
The maximum MTU setting for jumbo frames is 9710. This corresponds to the
maximum jumbo frame size of 9728 bytes.
.IP \(bu 2
This driver will attempt to use multiple page sized buffers to receive
each jumbo packet. This should help to avoid buffer starvation issues when
allocating receive packets.
.IP \(bu 2
Packet loss may have a greater impact on throughput when you use jumbo
frames. If you observe a drop in performance after enabling jumbo frames,
enabling flow control may mitigate the issue.
.IP \(bu 2
For 82599\-based network connections, if you are enabling jumbo frames in
a virtual function (VF), jumbo frames must first be enabled in the physical
function (PF). The VF MTU setting cannot be larger than the PF MTU.
.UNINDENT
.UNINDENT
.UNINDENT
.SS Speed and Duplex Configuration
.sp
In addressing speed and duplex configuration issues, you need to distinguish
between copper\-based adapters and fiber\-based adapters.
.sp
In the default mode, an Intel(R) Ethernet Network Adapter using copper
connections will attempt to auto\-negotiate with its link partner to determine
the best setting. If the adapter cannot establish link with the link partner
using auto\-negotiation, you may need to manually configure the adapter and link
partner to identical settings to establish link and pass packets. This should
only be needed when attempting to link with an older switch that does not
support auto\-negotiation or one that has been forced to a specific speed or
duplex mode. Your link partner must match the setting you choose. 1Gbps speeds
and higher cannot be forced. Use the autonegotiation advertising setting to
manually set devices for 1Gbps and higher.
.sp
Speed, duplex, and autonegotiation advertising are configured through the
ethtool utility.
.sp
To see the speed configurations your device supports, run the following:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool <ethX>
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
By default, devices based on the Intel(R) Ethernet Controller x550 do not
advertise 2.5Gbps or 5Gbps. To have your device advertise these speeds, use
the following:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-s <ethX> advertise N
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Where \fBN\fP is a combination of the following:
.INDENT 0.0
.TP
.B 100baseTFull
0x008
.TP
.B 1000baseTFull
0x020
.TP
.B 2500baseTFull
0x800000000000
.TP
.B 5000baseTFull
0x1000000000000
.TP
.B 10000baseTFull
0x1000
.UNINDENT
.sp
For example, to turn on all modes:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-s <ethX> advertise 0x1800000001028
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
For more details, refer to the ethtool man page.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
On Linux systems with \fBINTERFACES(5)\fP, this can be specified as
a \fBpre\-up\fP command in \fB/etc/network/interfaces\fP so that the interface is
always brought up with NBASE\-T support. For example:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
iface <ethX> inet dhcp
  pre\-up ethtool \-s <ethX> advertise 0x1800000001028 || true
.ft P
.fi
.UNINDENT
.UNINDENT
.UNINDENT
.UNINDENT
.sp
\fBIMPORTANT:\fP
.INDENT 0.0
.INDENT 3.5
Only experienced network administrators should force speed and
duplex or change autonegotiation advertising manually. The settings at the
switch must always match the adapter settings. Adapter performance may suffer
or your adapter may not operate if you configure the adapter differently
from your switch.
.UNINDENT
.UNINDENT
.sp
An Intel(R) Ethernet Network Adapter using fiber\-based connections, however,
will not attempt to auto\-negotiate with its link partner since those adapters
operate only in full duplex and only at their native speed.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
For the Intel(R) Ethernet Connection X552 10 GbE SFP+, you must
specify the desired speed.
.UNINDENT
.UNINDENT
.SS Link\-Level Flow Control (LFC)
.sp
Ethernet Flow Control (IEEE 802.3x) can be configured with ethtool to enable
receiving and transmitting pause frames for ixgbe. When transmit is enabled,
pause frames are generated when the receive packet buffer crosses a predefined
threshold. When receive is enabled, the transmit unit will halt for the time
delay specified when a pause frame is received.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
You must have a flow control capable link partner.
.UNINDENT
.UNINDENT
.sp
Flow Control is enabled by default.
.sp
Use ethtool to change the flow control settings.
.sp
To enable or disable Rx or Tx Flow Control:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-A <ethX> rx <on|off> tx <on|off>
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
This command only enables or disables Flow Control if
auto\-negotiation is disabled. If auto\-negotiation is enabled, this command
changes the parameters used for auto\-negotiation with the link partner.
.UNINDENT
.UNINDENT
.sp
To enable or disable auto\-negotiation:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-s <ethX> autoneg <on|off>
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
Flow Control auto\-negotiation is part of link auto\-negotiation. Depending
on your device, you may not be able to change the auto\-negotiation setting.
.IP \(bu 2
The ixgbe driver requires flow control on both the port and link partner.
If flow control is disabled on one of the sides, the port may appear to
hang on heavy traffic.
.IP \(bu 2
For 82598 backplane cards entering 1 gigabit mode, flow control default
behavior is changed to off. Flow control in 1 gigabit mode on these devices
can lead to transmit hangs.
.UNINDENT
.UNINDENT
.UNINDENT
.SS Intel(R) Ethernet Flow Director
.sp
The Intel(R) Ethernet Flow Director (Intel(R) Ethernet FD) performs the
following tasks:
.INDENT 0.0
.IP \(bu 2
Directs receive packets according to their flows to different queues
.IP \(bu 2
Enables tight control on routing a flow in the platform
.IP \(bu 2
Matches flows and CPU cores for flow affinity
.IP \(bu 2
Supports multiple parameters for flexible flow classification and load
balancing (in SFP mode only)
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
An included script (\fBset_irq_affinity\fP) automates setting the IRQ
to CPU affinity.
.UNINDENT
.UNINDENT
.sp
This driver supports the following flow types:
.INDENT 0.0
.IP \(bu 2
IPv4
.IP \(bu 2
TCPv4
.IP \(bu 2
UDPv4
.IP \(bu 2
SCTPv4
.IP \(bu 2
TCPv6
.IP \(bu 2
UDPv6
.UNINDENT
.sp
Each flow type supports valid combinations of IP addresses (source or
destination) and UDP/TCP ports (source and destination). You can supply only a
source IP address, a source IP address and a destination port, or any
combination of one or more of these four parameters.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
This driver does not support IPv6 source or destination IP addresses.
.UNINDENT
.UNINDENT
.sp
See the Intel(R) Ethernet Adapters and Devices User Guide for a table that
summarizes supported Intel Ethernet Flow Director features across Intel(R)
Ethernet controllers.
.SS Sideband Perfect Filters
.sp
Sideband Perfect Filters are used to direct traffic that matches specified
characteristics. They are enabled through ethtool\(aqs ntuple interface. To enable
or disable the Intel Ethernet Flow Director and these filters:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-K <ethX> ntuple <off|on>
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
When you disable ntuple filters, all the user programmed filters are
flushed from the driver cache and hardware. All needed filters must be
re\-added when ntuple is re\-enabled.
.UNINDENT
.UNINDENT
.sp
To display all of the active filters:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-u <ethX>
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
To add a new filter:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-U <ethX> flow\-type <type> src\-ip <ip> [m <ip_mask>] dst\-ip <ip>
[m <ip_mask>] src\-port <port> [m <port_mask>] dst\-port <port> [m <port_mask>]
action <queue>
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Where:
.INDENT 0.0
.TP
.B <ethX>
The Ethernet device to program.
.TP
.B <type>
Can be ip4, tcp4, udp4, sctp4, ip6, tcp6, udp6, sctp6.
.TP
.B <ip>
The IP address to match on.
.TP
.B <ip_mask>
The IPv4 address to mask on.
.sp
\fBNOTE:\fP
.INDENT 7.0
.INDENT 3.5
These filters use inverted masks.
.UNINDENT
.UNINDENT
.TP
.B <port>
The port number to match on.
.TP
.B <port_mask>
The 16\-bit integer for masking.
.sp
\fBNOTE:\fP
.INDENT 7.0
.INDENT 3.5
These filters use inverted masks.
.UNINDENT
.UNINDENT
.TP
.B <queue>
The queue to direct traffic toward (\fB\-1\fP discards the matched
traffic).
.UNINDENT
.sp
To delete a filter:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-U <ethX> delete <N>
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Where \fB<N>\fP is the filter ID displayed when printing all the active filters,
and may also have been specified using \fBloc <N>\fP when adding the filter.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
Intel Ethernet Flow Director masking works in the opposite manner
from subnet masking. For instance, in the following command:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-U eth11 flow\-type ip4 src\-ip 172.4.1.2 m 255.0.0.0 dst\-ip \e
172.21.1.1 m 255.128.0.0 action 31
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
The \fBsrc\-ip\fP value that is written to the filter will be 0.4.1.2, not
172.0.0.0 as might be expected. Similarly, the \fBdst\-ip\fP value written to
the filter will be 0.21.1.1, not 172.0.0.0.
.UNINDENT
.UNINDENT
.sp
EXAMPLES:
.sp
To add a filter that directs packet to queue 2:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-U <ethX> flow\-type tcp4 src\-ip 192.168.10.1 dst\-ip \e
192.168.10.2 src\-port 2000 dst\-port 2001 action 2 [loc 1]
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
To set a filter using only the source and destination IP address:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-U <ethX> flow\-type tcp4 src\-ip 192.168.10.1 dst\-ip \e
192.168.10.2 action 2 [loc 1]
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
To match TCP traffic sent from 192.168.0.1, port 5300, directed to 192.168.0.5,
port 80, and then send it to queue 7:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-U enp130s0 flow\-type tcp4 src\-ip 192.168.0.1 dst\-ip 192.168.0.5
src\-port 5300 dst\-port 80 action 7
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
To add a TCPv4 filter with a partial mask for a source IP:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-U <ethX> flow\-type tcp4 src\-ip 192.168.0.0 m 0.255.255.255 dst\-ip
192.168.5.12 src\-port 12600 dst\-port 31 action 12
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
For each flow\-type, the programmed filters must all have the same matching
input set. For example, issuing the following two commands is acceptable:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-U enp130s0 flow\-type ip4 src\-ip 192.168.0.1 src\-port 5300 action 7
ethtool \-U enp130s0 flow\-type ip4 src\-ip 192.168.0.5 src\-port 55 action 10
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Issuing the next two commands, however, is not acceptable, since the first
specifies \fBsrc\-ip\fP and the second specifies \fBdst\-ip\fP:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-U enp130s0 flow\-type ip4 src\-ip 192.168.0.1 src\-port 5300 action 7
ethtool \-U enp130s0 flow\-type ip4 dst\-ip 192.168.0.5 src\-port 55 action 10
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
The second command will fail with an error. You may program multiple filters
with the same fields, using different values, but, on one device, you may not
program two tcp4 filters with different matching fields.
.sp
The ixgbe driver does not support matching on a subportion of a field, thus
partial mask fields are not supported.
.UNINDENT
.UNINDENT
.SS Filters to Direct Traffic to a Specific VF
.sp
It is possible to create filters that direct traffic to a specific Virtual
Function. For older versions of ethtool, this depends on the \fBaction\fP
parameter. Specify the action as a 64\-bit value, where the lower 32 bits
represent the queue number, while the next 8 bits represent the VF ID. Note
that 0 is the PF, so the VF identifier is offset by 1. For example:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-U <ethX> flow\-type tcp4 src\-ip 192.168.10.1 dst\-ip \e
192.168.10.2 src\-port 2000 dst\-port 2001 action 0x800000002 [loc 1]
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
The \fBaction\fP field specifies to direct traffic to Virtual Function 7
(8 minus 1) into queue 2 of that VF.
.sp
Newer versions of ethtool (version 4.11 and later) use \fBvf\fP and \fBqueue\fP
parameters instead of the \fBaction\fP parameter. Note that using the new ethtool
\fBvf\fP parameter does not require the value to be offset by 1. This command is
equivalent to the above example:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-U <ethX> flow\-type tcp4 src\-ip 192.168.10.1 dst\-ip \e
192.168.10.2 src\-port 2000 dst\-port 2001 vf 7 queue 2 [loc 1]
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Note that these filters will not break internal routing rules, and will not
route traffic that otherwise would not have been sent to the specified VF.
.SS Flex Byte Intel Ethernet Flow Director Filters
.sp
The driver also supports matching user\-defined data within the packet payload.
This flexible data is specified using the \fBuser\-def\fP field of the ethtool
command in the following way:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
+\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-+\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-+
| 31    28    24    20    16 | 15    12    8    4    0  |
+\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-+\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-+
| offset into packet payload | 2 bytes of flexible data |
+\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-+\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-+
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
For example:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
\&... user\-def 0x4FFFF ...
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
tells the filter to look 4 bytes into the payload and match that value against
0xFFFF. The offset is based on the beginning of the payload, and not the
beginning of the packet. Thus:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
flow\-type tcp4 ... user\-def 0x8BEAF ...
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
would match TCP/IPv4 packets which have the value 0xBEAF 8 bytes into the
TCP/IPv4 payload.
.sp
Note that ICMP headers are parsed as 4 bytes of header and 4 bytes of payload.
Thus to match the first byte of the payload, you must actually add 4 bytes to
the offset. Also note that ip4 filters match both ICMP frames as well as raw
(unknown) ip4 frames, where the payload will be the L3 payload of the IP4 frame.
.sp
The maximum offset is 64. The hardware will only read up to 64 bytes of data
from the payload. The offset must be even because the flexible data is 2 bytes
long and must be aligned to byte 0 of the packet payload.
.sp
The user\-defined flexible offset is also considered part of the input set and
cannot be programmed separately for multiple filters of the same type. However,
the flexible data is not part of the input set and multiple filters may use the
same offset but match against different data.
.SS Support for UDP RSS
.sp
This feature adds an ON/OFF switch for hashing over certain flow types. Only
UDP can be turned on. The default setting is disabled.
.sp
Only support for enabling/disabling hashing on ports for UDP over IPv4 (UDP4) or
IPv6 (UDP6) is supported.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
Fragmented packets may arrive out of order when RSS UDP support is
configured.
.UNINDENT
.UNINDENT
.sp
Supported Ethtool Commands and Options:
.INDENT 0.0
.TP
.B  \-n\fP,\fB  \-\-show\-nfc
Retrieves the receive network flow classification configurations.
.UNINDENT
.INDENT 0.0
.TP
.B \-n rx\-flow\-hash tcp4|udp4|ah4|esp4|sctp4|tcp6|udp6|ah6|esp6|sctp6
Retrieves the hash options for the specified network traffic type.
.UNINDENT
.INDENT 0.0
.TP
.B  \-N\fP,\fB  \-\-config\-nfc
Configures the receive network flow classification.
.UNINDENT
.INDENT 0.0
.TP
.B \-N rx\-flow\-hash tcp4|udp4|ah4|esp4|sctp4|tcp6|udp6|ah6|esp6|sctp6|m|v|t|s|d|f|n|r...
Configures the hash options for the specified network traffic type.
.INDENT 7.0
.TP
.B udp4
UDP over IPv4
.TP
.B udp6
UDP over IPv6
.TP
.B f
Hash on bytes 0 and 1 of the Layer 4 header of the Rx packet.
.TP
.B n
Hash on bytes 2 and 3 of the Layer 4 header of the Rx packet.
.UNINDENT
.UNINDENT
.sp
The following is an example using udp4 (UDP over IPv4):
.INDENT 0.0
.IP \(bu 2
To include UDP port numbers in RSS hashing:
.INDENT 2.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-N <ethX> rx\-flow\-hash udp4 sdfn
.ft P
.fi
.UNINDENT
.UNINDENT
.IP \(bu 2
To exclude UDP port numbers from RSS hashing:
.INDENT 2.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-N <ethX> rx\-flow\-hash udp4 sd
.ft P
.fi
.UNINDENT
.UNINDENT
.IP \(bu 2
To display UDP hashing current configuration:
.INDENT 2.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-n <ethX> rx\-flow\-hash udp4
.ft P
.fi
.UNINDENT
.UNINDENT
.UNINDENT
.sp
The results of running that call will be the following, if UDP hashing is
enabled:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
UDP over IPV4 flows use these fields for computing Hash flow key:
  IP SA
  IP DA
  L4 bytes 0 & 1 [TCP/UDP src port]
  L4 bytes 2 & 3 [TCP/UDP dst port]
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
The results if UDP hashing is disabled are shown below:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
UDP over IPV4 flows use these fields for computing Hash flow key:
  IP SA
  IP DA
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
Parameters \fBFdirPballoc\fP and \fBAtrSampleRate\fP impact Intel
Ethernet Flow Director.
.UNINDENT
.UNINDENT
.SS Data Center Bridging (DCB)
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
The kernel assumes that TC0 is available, and will disable Priority
Flow Control (PFC) on the device if TC0 is not available. To fix this, ensure
TC0 is enabled when setting up DCB on your switch.
.UNINDENT
.UNINDENT
.sp
DCB is a configuration Quality of Service implementation in hardware. It uses
the VLAN priority tag (802.1p) to filter traffic. That means that there are 8
different priorities that traffic can be filtered into. It also enables
priority flow control (802.1Qbb) which can limit or eliminate the number of
dropped packets during network stress. Bandwidth can be allocated to each of
these priorities, which is enforced at the hardware level (802.1Qaz).
.sp
DCB is normally configured on the network using the DCBX protocol (802.1Qaz), a
specialization of LLDP (802.1AB). The ixgbe driver supports the following
variants of DCBX support:
.INDENT 0.0
.IP \(bu 2
Software\-based DCBX mode only
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
Intel Ethernet 500 Series adapters do not support firmware DCBX.
.UNINDENT
.UNINDENT
.sp
In software\-based mode, LLDP traffic is forwarded to the network stack and user
space, where a software agent can handle it. In this mode, the adapter can
operate in either \(dqwilling\(dq or \(dqnonwilling\(dq DCBX mode and DCB configuration can
be both queried and set locally.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
In software\-based DCBX mode, you can configure DCB parameters using
software LLDP/DCBX agents that interface with the Linux kernel\(aqs DCB
Netlink API. We recommend using OpenLLDP as the DCBX agent when running
in software mode. For more information, see the OpenLLDP man pages and
\fI\%https://github.com/intel/openlldp\fP\&.
.UNINDENT
.UNINDENT
.SS Configuring VLAN Tagging on SR\-IOV Enabled Adapter Ports
.sp
To configure VLAN tagging for the ports on an SR\-IOV enabled adapter, use the
following command. The VLAN configuration should be done before the VF driver
is loaded or the VM is booted. The VF is not aware of the VLAN tag being
inserted on transmit and removed on received frames (sometimes called \(dqport
VLAN\(dq mode).
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ip link set dev <ethX> vf <id> vlan <vlan id>
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
For example, the following will configure PF eth0 and the first VF on VLAN 10:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ip link set dev eth0 vf 0 vlan 10
.ft P
.fi
.UNINDENT
.UNINDENT
.SS Controlling the VF link state
.sp
The ixgbe PF driver allows a root user to disable the VF link state using
iproute2.
.sp
To control the VF link state, use the following:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ip link set <ethX> vf <number> state auto|disable
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Where:
.INDENT 0.0
.TP
.B auto
Automatically reflects the link state from the PF to the VF (default).
.TP
.B disable
Tells the hardware to drop any packets sent by the VF.
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
The ixgbe driver does not support the \fBenable\fP option. If the
command does not work, it may not be supported by your system.
.UNINDENT
.UNINDENT
.SS Virtual Function (VF) Tx Rate Limit
.sp
Use the ip command to configure the Tx rate limit for a VF from the PF
interface.
.sp
For example, to set a Tx rate limit of 1000Mbps for VF 0:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ip link set eth0 vf 0 rate 1000
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Note that the limit is set per queue and not for the entire VF interface.
.SS Malicious Driver Detection (MDD) for VFs
.sp
Some Intel Ethernet devices use Malicious Driver Detection (MDD) to detect
malicious traffic from the VF and disable Tx/Rx queues or drop the offending
packet until a VF driver reset occurs. You can view MDD messages in the PF\(aqs
system log using the dmesg command.
.INDENT 0.0
.IP \(bu 2
If the PF driver logs MDD events from the VF, confirm that the correct VF
driver is installed.
.IP \(bu 2
To restore functionality, you can manually reload the VF or VM.
.UNINDENT
.sp
On devices based on the Intel Ethernet Controller X520, the ixgbe driver will
detect certain types of misbehavior from the VF and automatically disable the
VF by default. To change this behavior, use the following command:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-\-set\-priv\-flags <ethX> mdd\-disable\-vf on|off
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Where:
.INDENT 0.0
.TP
.B on
Disables the VF if the PF detects VF misbehavior.
.TP
.B off
Resets but does not disable the VF if the PF detects VF misbehavior.
.UNINDENT
.SS MAC and VLAN Anti\-Spoofing Feature for VFs
.sp
When a malicious driver on a Virtual Function (VF) interface attempts to send a
spoofed packet, it is dropped by the hardware and not transmitted.
.sp
An interrupt is sent to the PF driver notifying it of the spoof attempt. When a
spoofed packet is detected, the PF driver will send the following message to
the system log (displayed by the \fBdmesg\fP command), where \fBX\fP is the PF
interface number and \fBn\fP is number of spoofed packets:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ixgbe <ethX>: ixgbe_spoof_check: n spoofed packets detected
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
This feature can be disabled for a specific VF:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ip link set <ethX> vf <vf id> spoofchk {off|on}
.ft P
.fi
.UNINDENT
.UNINDENT
.UNINDENT
.UNINDENT
.SS Setting MAC Address, VLAN, and Rate Limit Using IProute2 Tool
.sp
You can set a MAC address of a Virtual Function (VF), a default VLAN, and the
rate limit using the IProute2 tool. Download the latest version of the
IProute2 tool from Sourceforge if your version does not have all the features
you require.
.SS Wake on LAN (WoL) Support
.sp
Some adapters do not support Wake on LAN (WoL). To determine if your adapter
supports WoL, run the following command:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool <ethX>
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
WoL is configured through the ethtool utility. If your Linux distribution does
not include ethtool, download and install it from the following website:
\fI\%https://kernel.org/pub/software/network/ethtool/\fP\&.
.sp
For instructions on enabling WoL with ethtool, refer to the website listed
above.
.sp
WoL will be enabled on the system during the next shutdown or reboot. For this
driver version, in order to enable WoL, the ixgbe driver must be loaded prior
to shutting down or suspending the system.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
The Intel(R) Ethernet Converged Network Adapter X550\-T1 and Intel(R)
Ethernet Converged Network Adapter X550\-T2 have a manageability/AUX power
connector. These devices only support WoL if AUX power is supplied via this
connector. Note that this is system and adapter specific. Some with this
connector do not support WoL. Some systems do not provide the correct power
connection. See your system documentation for details.
.UNINDENT
.UNINDENT
.SS Firmware Logs
.sp
Intel Ethernet E610 Series devices support Firmware Logs. The ixgbe driver
allows you to generate firmware logs for supported categories of events, to
help debug issues with Customer Support.
.INDENT 0.0
.IP \(bu 2
The driver supports firmware logging via the debugfs interface on PF 0 only.
.IP \(bu 2
Firmware logs are stored in a data file in binary form.
.UNINDENT
.sp
The following operations are supported.
.sp
Activate Firmware Logs:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
echo 1 > /sys/kernel/debug/ixgbe/0000:18:00.0/fwlog/enable
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Save data to a file:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
cat /sys/kernel/debug/ixgbe/0000:18:00.0/fwlog/data > fwlog.bin
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
The Firmware Logs can be configured by writing to the \(aqfwlog/modules\(aq file like
this:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
echo <fwlog_event> <fwlog_level> > /sys/kernel/debug/ixgbe/0000:18:00.0/fwlog/modules
.ft P
.fi
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP \(bu 2
\fB<fwlog_event>\fP represents the following supported events:
.INDENT 2.0
.IP \(bu 2
\fBCTRL\fP \- Control
.IP \(bu 2
\fBLINK\fP \- Link Management
.IP \(bu 2
\fBLINK_TOPO\fP \- Link Topology Detection
.IP \(bu 2
\fBI2C\fP \- I2C
.IP \(bu 2
\fBSDP\fP \- SDP
.IP \(bu 2
\fBMDIO\fP \- MDIO
.IP \(bu 2
\fBADMINQ\fP \- Admin Queue
.IP \(bu 2
\fBNVM\fP \- NVM
.IP \(bu 2
\fBAUTH\fP \- Authentication
.IP \(bu 2
\fBVPD\fP \- Vital Product Data
.IP \(bu 2
\fBIOSF\fP \- Intel On\-Chip System Fabric
.IP \(bu 2
\fBWATCHDOG\fP \- Watchdog
.IP \(bu 2
\fBTASK_DISPATCH\fP \- Task Dispatcher
.IP \(bu 2
\fBMNG\fP \- Manageability
.IP \(bu 2
\fBHEALTH\fP \- Health
.IP \(bu 2
\fBTSDRV\fP \- Time Sync
.IP \(bu 2
\fBPFREG\fP \- PF Registration
.IP \(bu 2
\fBMDLVER\fP \- Module Version
.IP \(bu 2
\fBALL\fP \- Allows to set all of the modules to the specified \fBfwlog_level\fP or
to read the \fBfwlog_level\fP of all of the modules
.UNINDENT
.IP \(bu 2
\fB<fwlog_level>\fP is the desired verbosity level of the firmware logs. Supported
values include:
.INDENT 2.0
.IP \(bu 2
NONE
.IP \(bu 2
ERROR
.IP \(bu 2
WARNING
.IP \(bu 2
NORMAL
.IP \(bu 2
VERBOSE
.UNINDENT
.UNINDENT
.sp
Example usage to configure the modules:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
echo LINK VERBOSE > /sys/kernel/debug/ixgbe/0000:18:00.0/fwlog/modules
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
The Firmware Logs resolution can be adjusted using following command:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
echo 50 > /sys/kernel/debug/ixgbe/0000:18:00.0/fwlog/resolution
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Example value 50 means that Firmware will send at least 50 messages per single
event. Available values are within 1..128 range.
.sp
The Firmware Logs buffers can be configured by following command:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
echo 128 > /sys/kernel/debug/ixgbe/0000:18:00.0/fwlog/nr_buffs
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Memory for allocation of 128 ring buffers is requested here. The available
values are within 1..512 range. In X86 architecture, ring buffers are 4 kb in
size for Firmware Logs. So, Ring buffers shall have at least 4kb size for
other CPU architectures too.
.SS Debug Dump
.sp
Intel Ethernet E610 Series devices support debug dump, which allows you to
obtain runtime register values from the firmware for \(dqclusters\(dq of events and
then write the results to a single dump file, for debugging complicated issues
in the field.
.sp
This debug dump contains a snapshot of the device and its existing hardware
configuration, such as switch tables, transmit scheduler tables, and other
information. Debug dump captures the current state of the specified cluster(s)
and is a stateless snapshot of the whole device.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
Like with firmware logs, the contents of the debug dump are not
human\-readable. You must work with Customer Support to decode the file.
.IP \(bu 2
Debug dump is per device, not per PF.
.UNINDENT
.UNINDENT
.UNINDENT
.sp
The ixgbe driver uses the debugfs interface for debug dump. To generate a debug
dump file in Linux, do the following:
.INDENT 0.0
.IP 1. 3
Specify the cluster(s) to include in the dump file, using one of the
following commands. You can either set a single cluster or all clusters.
.INDENT 3.0
.IP \(bu 2
To dump all clusters:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
echo > /sys/kernel/debug/ixgbe/<pci_addr>/fw/dump_cluster_id
.ft P
.fi
.UNINDENT
.UNINDENT
.IP \(bu 2
To dump a single cluster:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
echo <cluster ID> > /sys/kernel/debug/ixgbe/<pci_addr>/fw/dump_cluster_id
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Possible values for \fB<cluster ID>\fP are:
.INDENT 3.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
0 \- Link
.IP \(bu 2
1 \- CSR
.UNINDENT
.UNINDENT
.UNINDENT
.UNINDENT
.sp
For example, to dump the CSR space, use the following:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
echo 1 > /sys/kernel/debug/ixgbe/<pci_addr>/fw/dump_cluster_id
.ft P
.fi
.UNINDENT
.UNINDENT
.IP 2. 3
Save the debug dump to a file, using one of the following. Replace the
\fB\&.bin\fP name with the file name you want to use. For example:
.INDENT 3.0
.IP \(bu 2
For the file dumped using one of the previous commands:
.INDENT 3.0
.INDENT 3.5
.sp
.nf
.ft C
cat /sys/kernel/debug/ixgbe/<pci_addr>/fw/debug_dump > ~/single_cluster_dump.bin
.ft P
.fi
.UNINDENT
.UNINDENT
.UNINDENT
.UNINDENT
.SS IEEE 1588 Precision Time Protocol (PTP) Hardware Clock (PHC)
.sp
Precision Time Protocol (PTP) is used to synchronize clocks in a computer
network. PTP support varies among Intel devices that support this driver. Use
the following command to get a definitive list of PTP capabilities supported by
the device:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-T <ethX>
.ft P
.fi
.UNINDENT
.UNINDENT
.SS PTP packet timestamping
.sp
Precision Time Protocol uses packet Tx/Rx timestamping to measure delays and
synchronize time between the leader and the follower clocks.
Basic HW timestamping is done on the MAC layer. Due to HW configuration and PTP
timing constraints, on link speeds lower than 2.5G or for one\-step PTP Tx
timestamping operation PHY timestamping is used instead. This is more precise
method of timestamping and is completely transparent to end user.
For packets other than PTP ones, HW timestamping is done on the MAC layer
regardless of speed.
.SS Tunnel/Overlay Stateless Offloads
.sp
Supported tunnels and overlays include VXLAN, GENEVE, and others depending on
hardware and software configuration. Stateless offloads are enabled by default.
.sp
To view the current state of all offloads:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-k <ethX>
.ft P
.fi
.UNINDENT
.UNINDENT
.SS Interrupt Rate Limiting
.sp
This driver supports an adaptive interrupt throttle rate (ITR) mechanism that
is tuned for general workloads. Use ethtool to customize the interrupt rate
control for specific workloads, adjusting the number of microseconds between
interrupts:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-C <ethX> rx\-usecs N
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Values for \fBN\fP can be:
.INDENT 0.0
.TP
.B 0
No limit
.TP
.B 1
Adaptive (default).
.TP
.B 2\-1022
Minimum microseconds between each interrupt.
.UNINDENT
.sp
The range of 0\-1022 microseconds provides an effective range of 978 to 500,000
interrupts per second. The underlying hardware supports granularity in 2us
intervals at 1Gbps and 10Gbps and 20us at 100Mbps, so adjacent values may
result in the same interrupt rate.
.sp
For lower CPU utilization:
.INDENT 0.0
.IP \(bu 2
Lower Rx and Tx interrupts per queue using ethtool.
.IP \(bu 2
Setting \fBrx\-usecs\fP to 125 will limit interrupts to about 8,000 interrupts
per second per queue:
.INDENT 2.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-C <ethX> rx\-usecs 125
.ft P
.fi
.UNINDENT
.UNINDENT
.UNINDENT
.sp
For reduced latency:
.INDENT 0.0
.IP \(bu 2
Disable ITR by setting \fBrx\-usecs\fP to 0 using ethtool:
.INDENT 2.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-C <ethX> rx\-usecs 0
.ft P
.fi
.UNINDENT
.UNINDENT
.UNINDENT
.SS Using Devlink to update a device\(aqs NVM
.sp
When you update the NVM on some devices, the update may use the devlink
interface, rather than the ethtool interface. This will happen if the following
are true:
.INDENT 0.0
.IP \(bu 2
You are updating an Intel Ethernet E610 Series device.
.IP \(bu 2
Your system is running a distro that supports the \fBdevlink dev flash\fP command.
.IP \(bu 2
The firmware currently installed on the device supports it.
.IP \(bu 2
The new NVM conforms to the correct PLDM format.
.UNINDENT
.sp
On devices that support it, you can also use the devlink command line directly
to update the device NVM. However, for a feature rich, usability experience
we recommend that you use NVMUpdate.
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
devlink dev flash pci/0000:63:00.0 file filename.bin
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Where:
.INDENT 0.0
.TP
.B pci/0000:63:00.0
The device you wish to update. You can get a list of devices
with the \fBdevlink dev info\fP command.
.TP
.B filename.bin
The file that contains the new NVM image.
.UNINDENT
.SH KNOWN ISSUES/TROUBLESHOOTING
.SS Software Issues
.sp
If your Intel Ethernet Network Connection is not working after installing the
driver, verify that you have installed the correct driver.
.sp
Intel(R) Active Management Technology 2.0, 2.1, and 2.5 are not supported in
conjunction with the Linux driver.
.SS Receive Error counts may be higher than the actual packet error count
.sp
When a packet is received with more than one error, two bad packets may be
reported. This affects all devices based on 10G, or faster, controllers.
.SS MAC address of Virtual Function changes unexpectedly
.sp
If a Virtual Function\(aqs MAC address is not assigned in the host, then the VF
(virtual function) driver will use a random MAC address. This random MAC
address may change each time the VF driver is reloaded. You can assign a static
MAC address in the host machine. This static MAC address will survive a VF
driver reload.
.SS SR\-IOV virtual functions have identical MAC addresses
.sp
When you create multiple SR\-IOV virtual functions, the VFs may have identical
MAC addresses. Only one VF will pass traffic, and all traffic on other VFs with
identical MAC addresses will fail. This is related to the
\fBMACAddressPolicy=persistent\fP setting in
\fB/usr/lib/systemd/network/99\-default.link\fP\&.
.sp
To resolve this issue, edit the \fB/usr/lib/systemd/network/99\-default.link\fP
file and change the \fBMACAddressPolicy\fP line to \fBMACAddressPolicy=none\fP\&. For
more information, see the systemd.link man page.
.SS Multiple Interfaces on Same Ethernet Broadcast Network
.sp
Due to the default ARP behavior on Linux, it is not possible to have one system
on two IP networks in the same Ethernet broadcast domain (non\-partitioned
switch) behave as expected. All Ethernet interfaces will respond to IP traffic
for any IP address assigned to the system. This results in unbalanced receive
traffic.
.sp
If you have multiple interfaces in a server, turn on ARP filtering by entering
the following:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
echo 1 > /proc/sys/net/ipv4/conf/all/arp_filter
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
This only works if your kernel\(aqs version is higher than 2.4.5.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
This setting is not saved across reboots. The configuration change
can be made permanent by adding the following line to the file
\fB/etc/sysctl.conf\fP:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
net.ipv4.conf.all.arp_filter = 1
.ft P
.fi
.UNINDENT
.UNINDENT
.UNINDENT
.UNINDENT
.sp
Another alternative is to install the interfaces in separate broadcast domains
(either in different switches or in a switch partitioned to VLANs).
.SS UDP Stress Test Dropped Packet Issue
.sp
Under small packet UDP stress with the ixgbe driver, the system may drop UDP
packets due to socket buffers being full. Setting the driver Intel Ethernet
Flow Control variables to the minimum may resolve the issue. You may also try
increasing the kernel\(aqs default buffer sizes by changing the values in:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
/proc/sys/net/core/rmem_default and rmem_max
.ft P
.fi
.UNINDENT
.UNINDENT
.SS Cisco Catalyst 4948\-10GE port resets may cause switch to shut down ports
.sp
82598\-based hardware can re\-establish link quickly and when connected to some
switches, rapid resets within the driver may cause the switch port to become
isolated due to \(dqlink flap.\(dq This is typically indicated by a yellow instead of
a green link light. Several operations may cause this problem, such as
repeatedly running ethtool commands that cause a reset.
.sp
A potential workaround is to use the Cisco IOS command \(dqno errdisable detect
cause all\(dq from the Global Configuration prompt, which enables the switch to
keep the interfaces up, regardless of errors.
.SS Rx Page Allocation Errors
.sp
\(dqPage allocation failure. order:0\(dq errors may occur under stress with kernels
2.6.25 and newer. This is caused by the way the Linux kernel reports this
stressed condition.
.SS DCB: GSO causes bandwidth allocation issues
.sp
In order for DCB to work correctly, Generic Segmentation Offload (GSO), also
known as software TSO, must be disabled using ethtool. Since the hardware
supports TSO (hardware offload of segmentation), GSO will not be running by
default. Use the following to query the GSO state:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
ethtool \-k <ethX>
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
When using 82598\-based network connections, ixgbe driver only supports 16
queues on a platform with more than 16 cores.
.sp
Due to known hardware limitations, RSS can only filter in a maximum of 16
receive queues.
.sp
82599, X540, X550\-based network connections support up to 64 queues.
.SS Lower than expected performance
.sp
Some PCIe x8 slots are actually configured as x4 slots. These slots have
insufficient bandwidth for full line rate with dual port and quad port devices.
In addition, if you put a PCIe v4.0 or v3.0\-capable adapter into a PCIe v2.x
slot, you cannot get full bandwidth. The driver detects this situation and
writes one of the following messages in the system log:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
PCI\-Express bandwidth available for this card is not sufficient for optimal
performance. For optimal performance a x8 PCI\-Express slot is required.
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
or:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
PCI\-Express bandwidth available for this device may be insufficient for
optimal performance. Please move the device to a different PCI\-e link with
more lanes and/or higher transfer rate.\(dq
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
If this error occurs, moving your adapter to a true PCIe v3.0 x8 slot will
resolve the issue.
.SS Running \fBethtool \-t <ethX>\fP command causes break between PF and test client
.sp
When there are active VFs, \fBethtool \-t\fP will only run the link test. The driver
will also log in syslog that VFs should be shut down to run a full diagnostic
test.
.SS Unable to obtain DHCP lease on boot with Red Hat
.sp
In configurations where the auto\-negotiation process takes more than 5 seconds,
the boot script may fail with the following message:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
<ethX>: failed. No link present. Check cable?
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
This error may occur even though the presence of link can be confirmed using
\fBethtool <ethX>\fP\&. In this case, try setting \fBLINKDELAY=30\fP in
\fB/etc/sysconfig/network\-scripts/ifdfg\-<ethX>\fP\&.
.sp
The same issue can occur during a network boot (via PXE) on Red Hat
distributions that use the dracut script:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
Warning: No carrier detected on interface <ethX>
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
In this case, add \fBrd.net.timeout.carrier=30\fP at the kernel command line.
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
Link time can vary. Adjust the \fBLINKDELAY\fP value accordingly.
.UNINDENT
.UNINDENT
.SS Host may reboot after removing PF when VF is active in guest
.sp
Using kernel versions earlier than 3.2, do not unload the PF driver with
active VFs. Doing this will cause your VFs to stop working until you reload
the PF driver and may cause a spontaneous reboot of your system.
.sp
Prior to unloading the PF driver, you must first ensure that all VFs are
no longer active. Do this by shutting down all VMs and unloading the VF driver.
.SS Out of memory issues on IA32 systems
.sp
The driver may consume a lot of memory based on the number of CPUs and network
interfaces. This leads to memory segmentation. Thus, the driver may not be
able to allocate enough memory. To resolve this, reduce the number of
descriptors using ethtool \-G or the number of queues through the RSS parameter.
.SS VLAN tags are stripped on kernels earlier than 2.6.36
.sp
In order to support DCB, kernels earlier than 2.6.36 strip VLAN tags for
VLAN0. This ensures connectivity using 802.1p frames between kernels that
have built\-in support and kernels that do not.
.sp
If the VLAN tags are necessary AND DCB is NOT used, disable VLAN stripping
on older kernels at build time with the following:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
make CFLAGS_EXTRA=\-DIXGBE_DISABLE_8021P_SUPPORT
.ft P
.fi
.UNINDENT
.UNINDENT
.SH SUPPORT
.sp
For general information, go to the Intel support website at
\fI\%https://www.intel.com/support/\fP
.sp
or the Intel Ethernet Linux project hosted by GitHub at
\fI\%https://github.com/intel/ethernet\-linux\-ixgbe\fP
.sp
If an issue is identified with the released source code on a supported kernel
with a supported adapter, contact Intel Customer Support at
\fI\%https://www.intel.com/content/www/us/en/support/products/36773/ethernet\-products.html\fP
.SH LICENSE
.sp
This program is free software; you can redistribute it and/or modify it under
the terms and conditions of the GNU General Public License, version 2, as
published by the Free Software Foundation.
.sp
This program is distributed in the hope it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE. See the GNU General Public License for more details.
.sp
You should have received a copy of the GNU General Public License along with
this program; if not, write to the Free Software Foundation, Inc., 51 Franklin
St \- Fifth Floor, Boston, MA 02110\-1301 USA.
.sp
The full GNU General Public License is included in this distribution in the
file called \(dqCOPYING\(dq.
.SH TRADEMARKS
.sp
Intel is a trademark or registered trademark of Intel Corporation or its
subsidiaries in the United States and/or other countries.
.sp
Other names and brands may be claimed as the property of others.
.SH AUTHOR
Intel
.SH COPYRIGHT
1999 - 2024, Intel Corporation
.\" Generated by docutils manpage writer.
.
